# 工作日报      -- 2019-12-16 --

## 1. 我的解读页、主题详情页、首页推荐信息流里的解读卡片添加点击头像和昵称跳转用户详情。

## 2. 解读页隐藏分享按钮

## 3. 解决解读页不显示更多主题按钮：

> 解决方案：将此处的显示逻辑改为只要有收录该解读的主题就显示更多按钮，不需要请求后台收录解读的数量。

## 4. 解决解读页面评论区删除评论之后评论总数没有立即改变问题：

> 发现设计问题：我们现在的项目很多功能都集成在弹窗组件里（popUps.vue）这样会导致添加或修改功能非常麻烦，而且稳定性也比较弱，组件之间的数据传递太复杂，应该将页面的功能集成在页面组件本身，弹窗组件只是做一个通知和判断，这样设计更符合高内聚原则。

## 5. 主题详情页解决时间戳错误问题：

> BUG现象：

>> 最初只是发现有的情报站下面的推送文章时间不对，按理说我们的推送文章应该是间隔时间均匀推送的，也就是打开情报站推送的文章应该都是近一两个小时内采集的文章，偶尔我们发现打开一个情报站下面收录的文章是之前五六个小时甚至几天前收录的文章，这种情况就是出现了问题，因为查询后端库该主题是有新推送文章的，而且在前端将该情报站详情页面刷新之后发现也是更新了推荐文章。这就是我们页面在获取新文章数据的时候出现了设计期望之外的情况，也就是出现了传说中的BUG！！！！！！！！

> 分析过程：

>> 由于我们的数据是通过时间戳来查询的，最开始发现这个问题的时候我们就想是不是时间戳的获取出现了问题，但是经过测试发现并不是时间戳导致的，虽然BUG的出现伴随着时间戳的问题但是时间戳却不是本质的原因只是问题的一个表象，所以我们排除时间戳问题，转而通过大量测试来寻找BUG出现的规律以及出发BUG的操作。在经过大量的测试我们摸出了问题的出现规律，首先这个问题的出现是因为情报站详情页没有通过页面上集成的返回栏组件实现页面的路由回退，因为如果是触发返回组件的返回事件，会在vuex里更新一个页面刷新标志，情报站详情页缓存钩子函数就是通过判断这个刷新标志来确定页面是否要执行刷新数据，但是即使没有通过返回组件实现页面返回我们依然有路由守卫进行拦截判断，但是路由守卫里只记录了几种需要重置刷新标志的情况，既然路由守卫没有拦截成功，就说明这个情况在之前设计的时候被我们遗漏了。

> 解决方法：

>> 我们找出了这个BUG出发的路径：

>>> 个人中心页 -> 订阅、关注、粉丝页 -> 情报站详情（触发BUG）

>>> 用户详情页 -> TA的订阅、关注、粉丝页 -> 情报站详情页 （触发BUG）

我们发现在这两种路由情况下我们访问情报站详情页然后通过手机系统自带的返回键进行返回的路由跳转就会绕开路由守卫的拦截，从而导致情报站详情页出现缓存不刷新的BUG。我们在路由守卫的拦截里添加上了对"/myFollowandFans"和"/userhobby"这两个路由的拦截解决了这个页面缓存不刷新的问题。

> 总结：

>> 就是BUG出现不要盲目地根据表像寻求解决办法，要通过大量的操作触发BUG来寻找BUG触发的规律，通过规律来分析BUG出现的原因，还有就是移动端应用页面的路由跳转判断最好放在路由守卫里判断，这样可以兼容多种返回情况路由跳转更稳定，逻辑也更加接近本质。














