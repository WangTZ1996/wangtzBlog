# 工作日报              -- 2020-1-13 --

## 1. 调研H5应用获取用户设备信息的方式，通过用户的设备信息来判断是应用PC布局还是移动端布局。

#### (1). H5原生获取UA方法 

*HTML DOM userAgent*

```javascript
navigator.userAgent
```

> *微信环境下的UA*

```javascript
Mozilla/5.0 (iPhone; CPU iPhone OS 9_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1 wechatdevtools/1.02.1907300 MicroMessenger/7.0.4 Language/zh_CN webview/15788822541747905 webdebugger port/20471 UA
```

> 其中的‘MicroMessenger’字段是表明微信环境的字段。

#### ***容易踩坑的点：***

> 通过‘navigator.userAgent’获取的UA他具体的格式是根据浏览器不同而不同的，所以我们的判断的时候不容易知道具体终端上他的UA字段里的大小写情况，这时我们为了好判断首先我们将H5获取的UA字段先统一转换成小写的字符串然后在判断这个转换成小写的字符串里是否有微信‘micromessenger’字段，如果有该字段则表明是微信环境打开的应用，可以直接调取小程序微信登录直接授权，如果没有则需要调取PC应用的微信登录程序通过扫码来登录。

#### ***判断UA中是否有某字段的方法：***

```javascript
navigator.userAgent.indexOf("MicroMessenger") != -1  
// 通过index来判断是否有字段，index为-1时表示字符串中不存在该字段。
```

## 2. 前端文案调整：

#### 创建情报站标题重复时的弹框文案修改为

*【】标题的情报站已存在，请换个标题*

## 3. 项目适配终端方式修改：

####(1). 由之前的单纯判断用户屏幕宽度从而切换展示的css样式改为通过判断用户的屏幕宽高比例来判断终端状态，即使用户使用的是电脑的显示器但是如果用户的屏幕竖向展示，那么项目的展示也按照移动端布局来。具体的比例是在layout.css文件中定义媒体查询，如果屏幕宽高比例小于11：8那么应用移动端样式，如果屏幕宽高比例大于11：8则应用PC端样式。












